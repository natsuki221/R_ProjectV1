library(ggplot2) # 載入繪圖套件
g <- ggplot(  # 使用繪圖函式產生繪圖物件
data=twn.map,  # 符合data.frame格式的繪圖資料
mapping=aes(   # 指定data 的欄位
x = long,  # x軸為經度
y = lat    # y軸為緯度
)) +
labs(title='台北市縣界地圖(解方一)')+
geom_path(show.legend=FALSE)  # 繪出座標路徑線
print(g) # 印出台北縣市界地圖
####### 繪製台北市界地圖解法二###################
library(rgdal) # 載入rgdal套件讀取shp地圖資料
twn.shp <- rgdal::readOGR( # 回傳Spatial class 之物件
dsn='data/mapdata201911261001', # 目前工作目錄下(或路徑)圖資目錄
use_iconv = TRUE, # 依據encoding參數給予內碼轉碼
encoding='UTF-8'  # 轉為UTF-8 內碼
)
source("~/Desktop/Work/R-Project/R/2_1_v01.R", echo=TRUE)
source("~/Desktop/Work/R-Project/R/2_1_v01.R", echo=TRUE)
library(tibble)
####### 繪製台北市界地圖解法一###################
library(tibble)
library(geojsonio)  # 載入處理GeoJSON資料套件
geojson.sp <- geojson_read( # 將下載之縣市GeoJSON圖資讀入變數
x= 'https://raw.githubusercontent.com/g0v/twgeojson/master/json/twCounty2010.geo.json',
what = "sp" # 指定回傳Spatial class 之物件
)
####### 繪製台北市界地圖解法一###################
library(tibble)
library(geojsonio)  # 載入處理GeoJSON資料套件
geojson.sp <- geojson_read( # 將下載之縣市GeoJSON圖資讀入變數
x= 'https://raw.githubusercontent.com/g0v/twgeojson/master/json/twCounty2010.geo.json',
what = "sp" # 指定回傳Spatial class 之物件
)
####### 繪製台北市界地圖解法一###################
library(tibble)
library(geojsonio)  # 載入處理GeoJSON資料套件
geojson.sp <- geojson_read( # 將下載之縣市GeoJSON圖資讀入變數
x= 'https://raw.githubusercontent.com/g0v/twgeojson/master/json/twCounty2010.geo.json',
what = "sp" # 指定回傳Spatial class 之物件
)
setwd('/Users/lintzujeng/Documents/GitHub/R_Project/merge')
library("tidyverse")
library("openxlsx")
odf <- read.xlsx('orange_market.xlsx')
weather <- read.csv('weather.csv', header = T)
names(odf)[1] = "id"
#weather$平均 <- NULL
#weather[6,] <- NA
weather2 <- weather[-6,]
weather2$平均 <- NULL
weather2$年.月 <- as.numeric(weather2$年.月)
View(weather2)
library(stringr)
weather.just <- data.frame(id = c(NA), 氣溫 = c(NA))
View(weather.just)
for (y in 1:nrow(weather2)) {
for(m in 1:ncol(weather2)){
print(weather2[y,m])
if (is.na(weather2[y, m])){
print("NA")
break
}
else if (weather2[y, m] > 2000){
year <- weather2[y, m] - 1911
}
else{
id.y = as.character(year)
if (m <= 10){
id.m = str_sub(colnames(weather2)[m], start = 2L, end = 2L)
id.all = str_c(id.y, "年", "0", id.m, "月")
}
else{
id.m = str_sub(colnames(weather2)[m], start = 2L, end = 3L)
id.all = str_c(id.y, "年", id.m, "月")
}
weather.just[nrow(weather.just) + 1,] = id.all
weather.just$氣溫[nrow(weather.just)] = weather2[y, m]
}
}
}
weather.just <- na.omit(weather.just)
weather.just$氣溫<-as.factor(weather.just$氣溫)
odf.merged <- inner_join(odf, weather.just, by = "id")
View(odf.merged)
hist.plot <- ggplot(data = odf.merged, aes(x = 氣溫)) +
geom_histogram()
hist.plot
hist.plot <- ggplot(data = odf.merged, aes(x = 氣溫, y = `交易量(公斤)`)) +
geom_histogram()
hist.plot
hist.plot <- ggplot(data = odf.merged, aes(x = 氣溫)) +
geom_histogram()
hist.plot
hist.plot <- ggplot(data = odf.merged, aes(x = 氣溫), stat = "count") +
geom_histogram()
hist.plot
hist.plot <- ggplot(data = odf.merged, aes(x = 氣溫)) +
geom_histogram(stat = "count")
hist.plot <- ggplot(data = odf.merged, aes(x = 氣溫)) +
geom_histogram(bins = 10)
hist.plot
hist.plot <- ggplot(data = odf.merged, aes(x = 氣溫)) +
stat_count(width = 10) +
geom_histogram(bins = 10)
hist.plot
rlang::last_error()
weather.just$氣溫<-as.numeric(weather.just$氣溫)
odf.merged <- inner_join(odf, weather.just, by = "id")
hist.plot <- ggplot(data = odf.merged, aes(x = 氣溫)) +
geom_histogram(bins = 10)
hist.plot
hist.plot <- ggplot(data = odf.merged, aes(x = 氣溫, y = `交易量(公斤)`)) +
geom_bar()
hist.plot
weather.just$氣溫<-as.factor(weather.just$氣溫)
odf.merged <- inner_join(odf, weather.just, by = "id")
hist.plot <- ggplot(data = odf.merged, aes(x = 氣溫, y = `交易量(公斤)`)) +
geom_bar()
hist.plot
hist.plot <- ggplot(data = odf.merged, aes(x = 氣溫, y = `交易量(公斤)`)) +
geom_bar(stat = "identify")
hist.plot <- ggplot(data = odf.merged, aes(x = 氣溫, y = `交易量(公斤)`)) +
geom_bar(stat = "identity")
hist.plot
?geom_histogram
hist.plot <- ggplot(data = odf.merged, aes(x = 氣溫, fill = `交易量(公斤)`)) +
geom_histogram()
hist.plot
weather.just$氣溫<-as.numeric(weather.just$氣溫)
odf.merged <- inner_join(odf, weather.just, by = "id")
hist.plot <- ggplot(data = odf.merged, aes(x = 氣溫, fill = `交易量(公斤)`)) +
geom_histogram()
hist.plot
hist.plot <- ggplot(data = odf.merged, aes(x = 氣溫)) +
geom_histogram(binwidth = 30)
hist.plot
hist.plot <- ggplot(data = odf.merged, aes(x = 氣溫)) +
geom_histogram(bins = 5)
hist.plot
temp.ranges <- table(cut(odf.merged, breaks = seq(0, 45, by = 5)))
weather.just$氣溫<-as.numeric(weather.just$氣溫)
temp.ranges <- table(cut(odf.merged, breaks = seq(0, 45, by = 5)))
weather.just <- na.omit(weather.just)
weather.just$氣溫<-as.numeric(weather.just$氣溫)
odf.merged <- inner_join(odf, weather.just, by = "id")
temp.ranges <- table(cut(odf.merged, breaks = seq(0, 45, by = 5)))
temp.ranges <- table(cut(odf.merged$氣溫, breaks = seq(0, 45, by = 5)))
temp.ranges
odf.merged$氣溫[4]
temp.trade <- c(0,0,0,0,0,0,0,0,0)
temp.trade[5]
for (trade in nrow(odf.merged$`交易量(公斤)`)) {
if (odf.merged$氣溫[trade] <= 5){
temp.trade[1] = temp.trade + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 5 & odf.merged$氣溫[trade] <= 10){
temp.trade[2] = temp.trade + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 10 & odf.merged$氣溫[trade] <= 15){
temp.trade[3] = temp.trade + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 15 & odf.merged$氣溫[trade] <= 20){
temp.trade[4] = temp.trade + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 20 & odf.merged$氣溫[trade] <= 25){
temp.trade[5] = temp.trade + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 25 & odf.merged$氣溫[trade] <= 30){
temp.trade[6] = temp.trade + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 30 & odf.merged$氣溫[trade] <= 35){
temp.trade[7] = temp.trade + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 35 & odf.merged$氣溫[trade] <= 40){
temp.trade[8] = temp.trade + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 40 & odf.merged$氣溫[trade] <= 45){
temp.trade[9] = temp.trade + odf.merged$`交易量(公斤)`[trade]
}
}
temp.trade
temp.ranges <- table(cut(odf.merged$氣溫, breaks = seq(0, 45, by = 5)))
temp.trade <- c(0,0,0,0,0,0,0,0,0)
for (trade in nrow(odf.merged$`交易量(公斤)`)) {
if (odf.merged$氣溫[trade] <= 5){
temp.trade[1] = temp.trade + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 5 && odf.merged$氣溫[trade] <= 10){
temp.trade[2] = temp.trade + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 10 && odf.merged$氣溫[trade] <= 15){
temp.trade[3] = temp.trade + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 15 && odf.merged$氣溫[trade] <= 20){
temp.trade[4] = temp.trade + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 20 && odf.merged$氣溫[trade] <= 25){
temp.trade[5] = temp.trade + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 25 && odf.merged$氣溫[trade] <= 30){
temp.trade[6] = temp.trade + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 30 && odf.merged$氣溫[trade] <= 35){
temp.trade[7] = temp.trade + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 35 && odf.merged$氣溫[trade] <= 40){
temp.trade[8] = temp.trade + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 40 && odf.merged$氣溫[trade] <= 45){
temp.trade[9] = temp.trade + odf.merged$`交易量(公斤)`[trade]
}
}
z<- 5
z > 3 && z <= 5
z > 3 & z <= 5
for (trade in nrow(odf.merged$`交易量(公斤)`)) {
if (odf.merged$氣溫[trade] <= 5){
temp.trade[1] = temp.trade + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 5 && odf.merged$氣溫[trade] <= 10){
temp.trade[2] = temp.trade + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 10 && odf.merged$氣溫[trade] <= 15){
temp.trade[3] = temp.trade + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 15 && odf.merged$氣溫[trade] <= 20){
temp.trade[4] = temp.trade + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 20 && odf.merged$氣溫[trade] <= 25){
temp.trade[5] = temp.trade + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 25 && odf.merged$氣溫[trade] <= 30){
temp.trade[6] = temp.trade + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 30 && odf.merged$氣溫[trade] <= 35){
temp.trade[7] = temp.trade + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 35 && odf.merged$氣溫[trade] <= 40){
temp.trade[8] = temp.trade + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 40 && odf.merged$氣溫[trade] <= 45){
temp.trade[9] = temp.trade + odf.merged$`交易量(公斤)`[trade]
}
}
for (trade in nrow(odf.merged$`交易量(公斤)`)) {
if (odf.merged$氣溫[trade] <= 5){
temp.trade[1] = temp.trade + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 5 && odf.merged$氣溫[trade] <= 10){
temp.trade[2] = temp.trade + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 10 && odf.merged$氣溫[trade] <= 15){
temp.trade[3] = temp.trade + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 15 && odf.merged$氣溫[trade] <= 20){
temp.trade[4] = temp.trade + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 20 && odf.merged$氣溫[trade] <= 25){
temp.trade[5] = temp.trade + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 25 && odf.merged$氣溫[trade] <= 30){
temp.trade[6] = temp.trade + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 30 && odf.merged$氣溫[trade] <= 35){
temp.trade[7] = temp.trade + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 35 && odf.merged$氣溫[trade] <= 40){
temp.trade[8] = temp.trade + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 40 && odf.merged$氣溫[trade] <= 45){
temp.trade[9] = temp.trade + odf.merged$`交易量(公斤)`[trade]
}
}
odf.merged$氣溫[1]
class(odf.merged$`交易量(公斤)`[5])
temp.trade[0] = 5
temp.trade[0] = temp.trade[0] + 5
temp.trade[0] <- temp.trade[0] + 5
temp.trade <- numeric(9)
temp.trade[0] <- temp.trade[0] + 5
class(temp.trade[1])
temp.trade[0]+5
temp.trade[0] <- temp.trade[0] + 5L
temp.trade[1] <- temp.trade[1] + 5L
temp.trade[1] <- temp.trade[1] + 5
temp.trade <- numeric(9)
for (trade in nrow(odf.merged$`交易量(公斤)`)) {
if (odf.merged$氣溫[trade] <= 5){
temp.trade[1] = temp.trade + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 5 && odf.merged$氣溫[trade] <= 10){
temp.trade[2] = temp.trade + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 10 && odf.merged$氣溫[trade] <= 15){
temp.trade[3] = temp.trade + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 15 && odf.merged$氣溫[trade] <= 20){
temp.trade[4] = temp.trade + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 20 && odf.merged$氣溫[trade] <= 25){
temp.trade[5] = temp.trade + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 25 && odf.merged$氣溫[trade] <= 30){
temp.trade[6] = temp.trade + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 30 && odf.merged$氣溫[trade] <= 35){
temp.trade[7] = temp.trade + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 35 && odf.merged$氣溫[trade] <= 40){
temp.trade[8] = temp.trade + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 40 && odf.merged$氣溫[trade] <= 45){
temp.trade[9] = temp.trade + odf.merged$`交易量(公斤)`[trade]
}
}
if (odf.merged$氣溫[1] > 5 && odf.merged$氣溫[1] <= 10){
temp.trade[2] = temp.trade + odf.merged$`交易量(公斤)`[1]
}
temp.trade <- numeric(9)
for (trade in nrow(odf.merged$`交易量(公斤)`)) {
if (odf.merged$氣溫[trade] <= 5){
temp.trade[1] = temp.trade[1] + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 5 && odf.merged$氣溫[trade] <= 10){
temp.trade[2] = temp.trade[2] + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 10 && odf.merged$氣溫[trade] <= 15){
temp.trade[3] = temp.trade[3] + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 15 && odf.merged$氣溫[trade] <= 20){
temp.trade[4] = temp.trade[4] + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 20 && odf.merged$氣溫[trade] <= 25){
temp.trade[5] = temp.trade[5] + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 25 && odf.merged$氣溫[trade] <= 30){
temp.trade[6] = temp.trade[6] + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 30 && odf.merged$氣溫[trade] <= 35){
temp.trade[7] = temp.trade[7] + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 35 && odf.merged$氣溫[trade] <= 40){
temp.trade[8] = temp.trade[8] + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 40 && odf.merged$氣溫[trade] <= 45){
temp.trade[9] = temp.trade[9] + odf.merged$`交易量(公斤)`[trade]
}
}
if (odf.merged$氣溫[1] > 5 && odf.merged$氣溫[1] <= 10){
temp.trade[2] = temp.trade[2] + odf.merged$`交易量(公斤)`[1]
}
temp.trade <- numeric(9)
for (trade in 1:nrow(odf.merged$`交易量(公斤)`)) {
if (odf.merged$氣溫[trade] <= 5){
temp.trade[1] = temp.trade[1] + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 5 && odf.merged$氣溫[trade] <= 10){
temp.trade[2] = temp.trade[2] + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 10 && odf.merged$氣溫[trade] <= 15){
temp.trade[3] = temp.trade[3] + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 15 && odf.merged$氣溫[trade] <= 20){
temp.trade[4] = temp.trade[4] + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 20 && odf.merged$氣溫[trade] <= 25){
temp.trade[5] = temp.trade[5] + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 25 && odf.merged$氣溫[trade] <= 30){
temp.trade[6] = temp.trade[6] + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 30 && odf.merged$氣溫[trade] <= 35){
temp.trade[7] = temp.trade[7] + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 35 && odf.merged$氣溫[trade] <= 40){
temp.trade[8] = temp.trade[8] + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 40 && odf.merged$氣溫[trade] <= 45){
temp.trade[9] = temp.trade[9] + odf.merged$`交易量(公斤)`[trade]
}
}
nrow(odf.merged$`交易量(公斤)`)
nrow(odf.merged$氣溫)
nrow(odf.merged)
temp.trade <- numeric(9)
for (trade in 1:nrow(odf.merged)) {
if (odf.merged$氣溫[trade] <= 5){
temp.trade[1] = temp.trade[1] + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 5 && odf.merged$氣溫[trade] <= 10){
temp.trade[2] = temp.trade[2] + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 10 && odf.merged$氣溫[trade] <= 15){
temp.trade[3] = temp.trade[3] + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 15 && odf.merged$氣溫[trade] <= 20){
temp.trade[4] = temp.trade[4] + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 20 && odf.merged$氣溫[trade] <= 25){
temp.trade[5] = temp.trade[5] + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 25 && odf.merged$氣溫[trade] <= 30){
temp.trade[6] = temp.trade[6] + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 30 && odf.merged$氣溫[trade] <= 35){
temp.trade[7] = temp.trade[7] + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 35 && odf.merged$氣溫[trade] <= 40){
temp.trade[8] = temp.trade[8] + odf.merged$`交易量(公斤)`[trade]
}
else if (odf.merged$氣溫[trade] > 40 && odf.merged$氣溫[trade] <= 45){
temp.trade[9] = temp.trade[9] + odf.merged$`交易量(公斤)`[trade]
}
}
temp.df <- data.frame(temp.ranges, temp.trade)
View(temp.df)
class(temp.df$Var1[1])
hist.plot <- ggplot(data = temp.df, aes(x = Var1, y = temp.trade)) +
geom_bar()
hist.plot
hist.plot <- ggplot(data = temp.df, aes(x = Var1, y = temp.trade)) +
geom_bar(stat = "identity")
hist.plot
?labels
?labs
temp.trade <- numeric(9)
for (trade in 1:nrow(odf.merged)) {
if (odf.merged$氣溫[trade] <= 5){
temp.trade[1] = temp.trade[1] + odf.merged$`交易金額(元)`[trade]
}
else if (odf.merged$氣溫[trade] > 5 && odf.merged$氣溫[trade] <= 10){
temp.trade[2] = temp.trade[2] + odf.merged$`交易金額(元)`[trade]
}
else if (odf.merged$氣溫[trade] > 10 && odf.merged$氣溫[trade] <= 15){
temp.trade[3] = temp.trade[3] + odf.merged$`交易金額(元)`[trade]
}
else if (odf.merged$氣溫[trade] > 15 && odf.merged$氣溫[trade] <= 20){
temp.trade[4] = temp.trade[4] + odf.merged$`交易金額(元)`[trade]
}
else if (odf.merged$氣溫[trade] > 20 && odf.merged$氣溫[trade] <= 25){
temp.trade[5] = temp.trade[5] + odf.merged$`交易金額(元)`[trade]
}
else if (odf.merged$氣溫[trade] > 25 && odf.merged$氣溫[trade] <= 30){
temp.trade[6] = temp.trade[6] + odf.merged$`交易金額(元)`[trade]
}
else if (odf.merged$氣溫[trade] > 30 && odf.merged$氣溫[trade] <= 35){
temp.trade[7] = temp.trade[7] + odf.merged$`交易金額(元)`[trade]
}
else if (odf.merged$氣溫[trade] > 35 && odf.merged$氣溫[trade] <= 40){
temp.trade[8] = temp.trade[8] + odf.merged$`交易金額(元)`[trade]
}
else if (odf.merged$氣溫[trade] > 40 && odf.merged$氣溫[trade] <= 45){
temp.trade[9] = temp.trade[9] + odf.merged$`交易金額(元)`[trade]
}
}
temp.df <- data.frame(temp.ranges, temp.trade)
hist.plot <- ggplot(data = temp.df, aes(x = Var1, y = temp.trade)) +
geom_bar(stat = "identity") +
xlab("Tempertures") +
ylab("Trades($)")
hist.plot
hist.plot <- ggplot(data = temp.df, aes(x = Var1, y = temp.trade)) +
geom_bar(stat = "identity") +
xlab("氣溫(度)") +
ylab("交易金額(元)")
hist.plot
ggsave(hist.plot, "hist.png")
hist.plot
ggsave(hist.plot, "hist.png")
ggsave("hist.png", hist.plot)
library(writexl)
write_xlsx(odf.merged, "merged_data.xlsx")
source("~/Documents/GitHub/R_Project/merge/merge_app.R", echo=TRUE)
temp.trade <- numeric(9)
temp.ranges <- table(cut(odf.merged$氣溫, breaks = seq(0, 45, by = 5)))
temp.ranges <- table(cut(odf.merged$氣溫, breaks = seq(15, 30, by = 2)))
temp.ranges
temp.ranges <- table(cut(odf.merged$氣溫, breaks = seq(15, 30, by = 2)))
temp.trade <- numeric(7)
for (trade in 1:nrow(odf.merged)) {
if (odf.merged$氣溫[trade] <= 17){
temp.trade[1] = temp.trade[1] + odf.merged$`交易金額(元)`[trade]
}
else if (odf.merged$氣溫[trade] > 17 && odf.merged$氣溫[trade] <= 19){
temp.trade[2] = temp.trade[2] + odf.merged$`交易金額(元)`[trade]
}
else if (odf.merged$氣溫[trade] > 19 && odf.merged$氣溫[trade] <= 21){
temp.trade[3] = temp.trade[3] + odf.merged$`交易金額(元)`[trade]
}
else if (odf.merged$氣溫[trade] > 21 && odf.merged$氣溫[trade] <= 23){
temp.trade[4] = temp.trade[4] + odf.merged$`交易金額(元)`[trade]
}
else if (odf.merged$氣溫[trade] > 23 && odf.merged$氣溫[trade] <= 25){
temp.trade[5] = temp.trade[5] + odf.merged$`交易金額(元)`[trade]
}
else if (odf.merged$氣溫[trade] > 25 && odf.merged$氣溫[trade] <= 27){
temp.trade[6] = temp.trade[6] + odf.merged$`交易金額(元)`[trade]
}
else if (odf.merged$氣溫[trade] > 27 && odf.merged$氣溫[trade] <= 29){
temp.trade[7] = temp.trade[7] + odf.merged$`交易金額(元)`[trade]
}
}
temp.df <- data.frame(temp.ranges, temp.trade)
hist.plot <- ggplot(data = temp.df, aes(x = Var1, y = temp.trade)) +
geom_bar(stat = "identity") +
xlab("氣溫(度)") +
ylab("交易金額(元)")
hist.plot
ggsave("hist.png", hist.plot)
library(writexl)
write_xlsx(odf.merged, "merged_data.xlsx")
