odf <- read.xlsx('orange_market.xlsx')
weather <- read.csv('weather.csv', header = T)
odf$id <- c(1:length(odf$日期))
#weather$平均 <- NULL
#weather[6,] <- NA
weather2 <- weather[-6,]
View(weather2)
weather2$平均 <- NULL
weather2$年.月 <- as.numeric(weather2$年.月)
head(weather2)
View(odf)
library(stringr)
ts = "test"
ts[1]
str_sub(ts)
str_sub(ts start = 1L, end = 1L)
str_sub(ts start = 1L, end = 2L)
str_sub(ts, start = 1L, end = 2L)
colnames(weather2[2, 2])
weather2[2,2]
names(weather2[2,2])
lapply(apply(weather2, 1, function(x) which(x1)), names)
which(weather2[2,2])
?which
?colnames
colnames(weather2)
class(colnames(weather2))
colnames(weather2)[1]
weather[1,1]
weather[0,0]
?for
;l
??for
jjj
id <- data.frame()
id <- data.frame(id = ())
id <- data.frame(id)
View(id)
id <- data.frame(id = )
id <- data.frame(id = ())
id <- data.frame(id = c())
View(id)
id <- data.frame(id = c(1))
id <- data.frame()
id$id[1] = 1
id <- data.frame(id = c())
id$id[1] = 1
View(id)
id <- data.frame(id = c(1))
id$id[1] = 1
id$id[1,] = 1
View(id)
id$id[0,] = 1
id$id[0] = 1
id$id[1] = 1
id$id[2] = 1
id <- data.frame(id = 2)
id$id[2] = 1
id <- data.frame(id = c(2))
id$id[2] = 1
?rbind
id <- data.frame(id = c(8))
id[2,] = 2
id <- data.frame(id)
View(id)
View(id)
id <- data.frame(id)
View(id)
View(id)
setwd('/Users/lintzujeng/Documents/GitHub/R_Project/merge')
library("tidyverse")
library("openxlsx")
odf <- read.xlsx('orange_market.xlsx')
weather <- read.csv('weather.csv', header = T)
odf$id <- c(1:length(odf$日期))
#weather$平均 <- NULL
#weather[6,] <- NA
weather2 <- weather[-6,]
weather2$平均 <- NULL
weather2$年.月 <- as.numeric(weather2$年.月)
library(stringr)
id <- data.frame(id)
View(id)
id[1,] = 2
id <- data.frame(id = c(NA))
id <- data.frame(id = c(NA))
for (y in 1:nrow(weather2)) {
for(m in 1:ncol(weather2)){
if (weather2[y, m] > 2000){
year <- y
year = year - 1911
}
else{
id.m = str_sub(colnames(weather2)[m], start = 2L, end = 2L)
id.y = as.character(year)
id = str_c(id.y, "年", "0", id.m, "月")
id[nrow(weather2) + 1,] = id
}
}
}
for (y in 1:nrow(weather2)) {
for(m in 1:ncol(weather2)){
if (weather2[y, m] > 2000){
year <- y
year = year - 1911
}
else{
id.m = str_sub(colnames(weather2)[m], start = 2L, end = 2L)
id.y = as.character(year)
id = str_c(id.y, "年", "0", id.m, "月")
id[nrow(id) + 1,] = id
}
}
}
nrow(id)
id <- data.frame(id = c(NA))
for (y in 1:nrow(weather2)) {
for(m in 1:ncol(weather2)){
if (weather2[y, m] > 2000){
year <- y
year = year - 1911
}
else{
id.m = str_sub(colnames(weather2)[m], start = 2L, end = 2L)
id.y = as.character(year)
id = str_c(id.y, "年", "0", id.m, "月")
id[nrow(id) + 1,] = id
}
}
}
id <- data.frame(id = c(NA))
nrow(id)
for (y in 1:nrow(weather2)) {
for(m in 1:ncol(weather2)){
if (weather2[y, m] > 2000){
year <- y
year = year - 1911
}
else{
id.m = str_sub(colnames(weather2)[m], start = 2L, end = 2L)
id.y = as.character(year)
id.all = str_c(id.y, "年", "0", id.m, "月")
id[nrow(id) + 1,] = id.all
}
}
}
View(id)
for (y in 1:nrow(weather2)) {
for(m in 1:ncol(weather2)){
print(weather2[y,m])
if (weather2[y, m] > 2000){
year <- y
year = year - 1911
}
else{
id.m = str_sub(colnames(weather2)[m], start = 2L, end = 2L)
id.y = as.character(year)
id.all = str_c(id.y, "年", "0", id.m, "月")
id[nrow(id) + 1,] = id.all
}
}
}
id <- data.frame(id = c(NA))
for (y in 1:nrow(weather2)) {
for(m in 1:ncol(weather2)){
print(weather2[y,m])
if (weather2[y, m] > 2000){
year <- y - 1911
}
else{
id.m = str_sub(colnames(weather2)[m], start = 2L, end = 2L)
id.y = as.character(year)
id.all = str_c(id.y, "年", "0", id.m, "月")
id[nrow(id) + 1,] = id.all
}
}
}
View(id)
id <- data.frame(id = c(NA))
for (y in 1:nrow(weather2)) {
for(m in 1:ncol(weather2)){
print(weather2[y,m])
if (weather2[y, m] > 2000){
year <- y
}
else{
id.m = str_sub(colnames(weather2)[m], start = 2L, end = 2L)
id.y = as.character(year)
id.all = str_c(id.y, "年", "0", id.m, "月")
id[nrow(id) + 1,] = id.all
}
}
}
id <- data.frame(id = c(NA))
for (y in 1:nrow(weather2)) {
for(m in 1:ncol(weather2)){
print(weather2[y,m])
if (weather2[y, m] > 2000){
year <- weather2[y, m] - 1911
}
else{
id.m = str_sub(colnames(weather2)[m], start = 2L, end = 2L)
id.y = as.character(year)
id.all = str_c(id.y, "年", "0", id.m, "月")
id[nrow(id) + 1,] = id.all
}
}
}
View(id)
id <- data.frame(id = c(NA))
for (y in 1:nrow(weather2)) {
for(m in 1:ncol(weather2)){
print(weather2[y,m])
if (weather2[y, m] > 2000){
year <- weather2[y, m] - 1911
}
else if (is.null(weather2[y, m])) {
break
}
else{
id.m = str_sub(colnames(weather2)[m], start = 2L, end = 2L)
id.y = as.character(year)
id.all = str_c(id.y, "年", "0", id.m, "月")
id[nrow(id) + 1,] = id.all
}
}
}
id <- data.frame(id = c(NA))
for (y in 1:nrow(weather2)) {
for(m in 1:ncol(weather2)){
print(weather2[y,m])
if (is.null(weather2[y, m])){
break
}
if (weather2[y, m] > 2000){
year <- weather2[y, m] - 1911
}
else{
id.m = str_sub(colnames(weather2)[m], start = 2L, end = 2L)
id.y = as.character(year)
id.all = str_c(id.y, "年", "0", id.m, "月")
id[nrow(id) + 1,] = id.all
}
}
}
View(id)
id <- data.frame(id = c(NA))
for (y in 1:nrow(weather2)) {
for(m in 1:ncol(weather2)){
print(weather2[y,m])
if (is.null(weather2[y, m])){
print("0")
break
}
if (weather2[y, m] > 2000){
year <- weather2[y, m] - 1911
}
else{
id.m = str_sub(colnames(weather2)[m], start = 2L, end = 2L)
id.y = as.character(year)
id.all = str_c(id.y, "年", "0", id.m, "月")
id[nrow(id) + 1,] = id.all
}
}
}
id <- data.frame(id = c(NA))
for (y in 1:nrow(weather2)) {
for(m in 1:ncol(weather2)){
print(weather2[y,m])
if (is.null()){
print("0")
break
}
if (weather2[y, m] > 2000){
year <- weather2[y, m] - 1911
}
else{
id.m = str_sub(colnames(weather2)[m], start = 2L, end = 2L)
id.y = as.character(year)
id.all = str_c(id.y, "年", "0", id.m, "月")
id[nrow(id) + 1,] = id.all
}
}
}
?break
library(stringr)
id <- data.frame(id = c(NA))
for (y in 1:nrow(weather2)) {
for(m in 1:ncol(weather2)){
print(weather2[y,m])
if (is.null(weather2[y, m])){
print("NULL")
break
}
if (weather2[y, m] > 2000){
year <- weather2[y, m] - 1911
}
else{
id.m = str_sub(colnames(weather2)[m], start = 2L, end = 2L)
id.y = as.character(year)
id.all = str_c(id.y, "年", "0", id.m, "月")
id[nrow(id) + 1,] = id.all
}
}
}
library(stringr)
id <- data.frame(id = c(NA))
for (y in 1:nrow(weather2)) {
for(m in 1:ncol(weather2)){
print(weather2[y,m])
if (is.null(weather2[y, m])){
print("NULL")
break
}
else if (weather2[y, m] > 2000){
year <- weather2[y, m] - 1911
}
else{
id.m = str_sub(colnames(weather2)[m], start = 2L, end = 2L)
id.y = as.character(year)
id.all = str_c(id.y, "年", "0", id.m, "月")
id[nrow(id) + 1,] = id.all
}
}
}
?is.null
id <- data.frame(id = c(NA))
for (y in 1:nrow(weather2)) {
for(m in 1:ncol(weather2)){
print(weather2[y,m])
if (is.na(weather2[y, m])){
print("NA")
break
}
else if (weather2[y, m] > 2000){
year <- weather2[y, m] - 1911
}
else{
id.m = str_sub(colnames(weather2)[m], start = 2L, end = 2L)
id.y = as.character(year)
id.all = str_c(id.y, "年", "0", id.m, "月")
id[nrow(id) + 1,] = id.all
}
}
}
View(id)
id <- data.frame(id = c(NA), temp = c(NA))
id <- data.frame(id = c(NA), temp = c(NA))
for (y in 1:nrow(weather2)) {
for(m in 1:ncol(weather2)){
print(weather2[y,m])
if (is.na(weather2[y, m])){
print("NA")
break
}
else if (weather2[y, m] > 2000){
year <- weather2[y, m] - 1911
}
else{
id.m = str_sub(colnames(weather2)[m], start = 2L, end = 2L)
id.y = as.character(year)
id.all = str_c(id.y, "年", "0", id.m, "月")
id[nrow(id) + 1,] = id.all
id$temp[nrow(id)] = weather2[y, m]
}
}
}
weather.just <- data.frame(id = c(NA), temp = c(NA))
View(weather.just)
weather.just <- data.frame(id = c(NA), temp = c(NA))
for (y in 1:nrow(weather2)) {
for(m in 1:ncol(weather2)){
print(weather2[y,m])
if (is.na(weather2[y, m])){
print("NA")
break
}
else if (weather2[y, m] > 2000){
year <- weather2[y, m] - 1911
}
else{
id.m = str_sub(colnames(weather2)[m], start = 2L, end = 2L)
id.y = as.character(year)
id.all = str_c(id.y, "年", "0", id.m, "月")
weather.just[nrow(id) + 1,] = id.all
weather.just$temp[nrow(id)] = weather2[y, m]
}
}
}
View(weather.just)
weather.just <- data.frame(id = c(NA), temp = c(NA))
for (y in 1:nrow(weather2)) {
for(m in 1:ncol(weather2)){
print(weather2[y,m])
if (is.na(weather2[y, m])){
print("NA")
break
}
else if (weather2[y, m] > 2000){
year <- weather2[y, m] - 1911
}
else{
id.m = str_sub(colnames(weather2)[m], start = 2L, end = 2L)
id.y = as.character(year)
id.all = str_c(id.y, "年", "0", id.m, "月")
weather.just[nrow(weather.just) + 1,] = id.all
weather.just$temp[nrow(weather.just)] = weather2[y, m]
}
}
}
na.omit(weather.just)
weather.just <- na.omit(weather.just)
?inner_join
names(odf)[1] = "id"
odf.merged <- inner_join(odf, weather.just, by = "id")
View(weather.just)
rlang::last_error()
rlang::last_trace()
odf.merged <- inner_join(odf, weather.just, by = "id")
weather.just <- data.frame(id = c(NA), temp = c(NA))
for (y in 1:nrow(weather2)) {
for(m in 1:ncol(weather2)){
print(weather2[y,m])
if (is.na(weather2[y, m])){
print("NA")
break
}
else if (weather2[y, m] > 2000){
year <- weather2[y, m] - 1911
}
else{
id.m = str_sub(colnames(weather2)[m], start = 2L, end = 2L)
id.y = as.character(year)
if (m < 10){
id.all = str_c(id.y, "年", "0", id.m, "月")
}
else{
id.all = str_c(id.y, "年", id.m, "月")
}
weather.just[nrow(weather.just) + 1,] = id.all
weather.just$temp[nrow(weather.just)] = weather2[y, m]
}
}
}
if (m <= 10){
id.all = str_c(id.y, "年", "0", id.m, "月")
}
weather.just <- data.frame(id = c(NA), temp = c(NA))
for (y in 1:nrow(weather2)) {
for(m in 1:ncol(weather2)){
print(weather2[y,m])
if (is.na(weather2[y, m])){
print("NA")
break
}
else if (weather2[y, m] > 2000){
year <- weather2[y, m] - 1911
}
else{
id.m = str_sub(colnames(weather2)[m], start = 2L, end = 2L)
id.y = as.character(year)
if (m <= 10){
id.all = str_c(id.y, "年", "0", id.m, "月")
}
else{
id.all = str_c(id.y, "年", id.m, "月")
}
weather.just[nrow(weather.just) + 1,] = id.all
weather.just$temp[nrow(weather.just)] = weather2[y, m]
}
}
}
weather.just <- data.frame(id = c(NA), temp = c(NA))
for (y in 1:nrow(weather2)) {
for(m in 1:ncol(weather2)){
print(weather2[y,m])
if (is.na(weather2[y, m])){
print("NA")
break
}
else if (weather2[y, m] > 2000){
year <- weather2[y, m] - 1911
}
else{
id.y = as.character(year)
if (m <= 10){
id.m = str_sub(colnames(weather2)[m], start = 2L, end = 2L)
id.all = str_c(id.y, "年", "0", id.m, "月")
}
else{
id.m = str_sub(colnames(weather2)[m], start = 2L, end = 3L)
id.all = str_c(id.y, "年", id.m, "月")
}
weather.just[nrow(weather.just) + 1,] = id.all
weather.just$temp[nrow(weather.just)] = weather2[y, m]
}
}
}
weather.just <- na.omit(weather.just)
odf.merged <- inner_join(odf, weather.just, by = "id")
source("~/Documents/GitHub/R_Project/merge/merge_app.R", echo=TRUE)
View(odf.merged)
weather.just <- data.frame(id = c(NA), 氣溫 = c(NA))
source("~/Documents/GitHub/R_Project/merge/merge_app.R", echo=TRUE)
library(writexl)
write_xlsx(odf.merged, "merged_data")
write_xlsx(odf.merged, "merged_data.xlsx")
source("~/Documents/GitHub/R_Project/merge/merge_app.R", echo=TRUE)
class(weather.just$氣溫)
as.numeric(weather.just$氣溫)
weather.just$氣溫<-as.numeric(weather.just$氣溫)
source("~/Documents/GitHub/R_Project/merge/merge_app.R", echo=TRUE)
